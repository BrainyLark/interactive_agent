INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:__main__:{'messages': [SystemMessage(content='\n    You are a barbershop AI agent that makes haircut appointments for users. And you must communicate in\n    Mongolian language. You MUST use the following tools to assist users:\n    - ask_user_for_input: Use this to get necessary information from the user (you must let the user confirm the suggested time and ask again)\n    - check_conflicting_appointment: Use this to verify if the requested time slot is available\n    - set_appointment: Use this to create the final appointment\n\n    For each appointment, you need to:\n    1. Gather necessary information using ask_user_for_input (name, preferred date and time)\n    2. Check if the time slot is available using check_conflicting_appointment (duration is 45 minutes)\n    3. Remember if there is a conflict in appointment, you must let the user confirm the suggested time and ask again using `ask_user_for_input` tool.\n    4. Create the appointment using set_appointment\n\n    Always use these tools to complete the task. Do not provide fictional responses.\n', additional_kwargs={}, response_metadata={}, id='aa92da75-d614-4c82-bf70-0dbca6a6c382'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_0eM9dPvG7KJ26gsO4d8NU67Z', 'function': {'arguments': '{"user_prompt":"Сайн байна уу? Таны нэр хэн бэ?"}', 'name': 'ask_user_for_input'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 30, 'prompt_tokens': 561, 'total_tokens': 591, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_d28bcae782', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-fc2ba894-31b8-4b77-817b-eb424007df7a-0', tool_calls=[{'name': 'ask_user_for_input', 'args': {'user_prompt': 'Сайн байна уу? Таны нэр хэн бэ?'}, 'id': 'call_0eM9dPvG7KJ26gsO4d8NU67Z', 'type': 'tool_call'}], usage_metadata={'input_tokens': 561, 'output_tokens': 30, 'total_tokens': 591, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='Эрдэнэбилэг', name='ask_user_for_input', id='0d70d354-acdc-436f-8e25-9e01b3b60e4a', tool_call_id='call_0eM9dPvG7KJ26gsO4d8NU67Z'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_GqEHZGShjaatrkndrmITeaCk', 'function': {'arguments': '{"user_prompt":"Сайн байна уу Эрдэнэбилэг? Та хэзээ захиалга хийхийг хүсэж байна вэ? Огноо болон цагийг оруулна уу. (Жишээ нь: 2023-10-12T14:00)"}', 'name': 'ask_user_for_input'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 71, 'prompt_tokens': 606, 'total_tokens': 677, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_d28bcae782', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-3ea7f01a-5651-419b-b9cc-503ac1f685b1-0', tool_calls=[{'name': 'ask_user_for_input', 'args': {'user_prompt': 'Сайн байна уу Эрдэнэбилэг? Та хэзээ захиалга хийхийг хүсэж байна вэ? Огноо болон цагийг оруулна уу. (Жишээ нь: 2023-10-12T14:00)'}, 'id': 'call_GqEHZGShjaatrkndrmITeaCk', 'type': 'tool_call'}], usage_metadata={'input_tokens': 606, 'output_tokens': 71, 'total_tokens': 677, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='2025 оны 3 сарын 27нд өглөө 11 цаг 30 минутанд үсээ засуулмаар байна л даа', name='ask_user_for_input', id='90542c4e-35a0-4a75-a011-33cf3602d4e7', tool_call_id='call_GqEHZGShjaatrkndrmITeaCk'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_AssZL8lhp3q6e6bEHLCS6VPY', 'function': {'arguments': '{"dt":"2025-03-27T11:30:00","duration":45}', 'name': 'check_conflicting_appointment'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 33, 'prompt_tokens': 717, 'total_tokens': 750, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_d28bcae782', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-dc480c13-51f2-48cb-807a-56c9ef03fe2e-0', tool_calls=[{'name': 'check_conflicting_appointment', 'args': {'dt': '2025-03-27T11:30:00', 'duration': 45}, 'id': 'call_AssZL8lhp3q6e6bEHLCS6VPY', 'type': 'tool_call'}], usage_metadata={'input_tokens': 717, 'output_tokens': 33, 'total_tokens': 750, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='Sorry, there is a conflict of appointment at 2025-03-27T11:30:00. However we suggest you to order at 2025-03-27T12:15:00.', name='check_conflicting_appointment', id='b4a66bce-6c9d-4c7f-ba64-a33df77fd924', tool_call_id='call_AssZL8lhp3q6e6bEHLCS6VPY'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_EIxuOrxhGeCZzrTIs0UwIoX4', 'function': {'arguments': '{"user_prompt":"Уучлаарай, 2025 оны 3 сарын 27-ны өдрийн 11:30 цагт захиалга хийх боломжгүй байна. Та 12:15 цагт захиалга хийхийг зөвшөөрч байна уу?"}', 'name': 'ask_user_for_input'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 68, 'prompt_tokens': 804, 'total_tokens': 872, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_d28bcae782', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-1c97b429-3f1d-4d8e-a4ce-51fb2c5c4dda-0', tool_calls=[{'name': 'ask_user_for_input', 'args': {'user_prompt': 'Уучлаарай, 2025 оны 3 сарын 27-ны өдрийн 11:30 цагт захиалга хийх боломжгүй байна. Та 12:15 цагт захиалга хийхийг зөвшөөрч байна уу?'}, 'id': 'call_EIxuOrxhGeCZzrTIs0UwIoX4', 'type': 'tool_call'}], usage_metadata={'input_tokens': 804, 'output_tokens': 68, 'total_tokens': 872, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='За би бараг амжихгүй байх. Тэгвэл өдөр нь 4 цагийн үед байвал яаж байна?', name='ask_user_for_input', id='dde96b04-e767-4a7c-8027-571d25f70308', tool_call_id='call_EIxuOrxhGeCZzrTIs0UwIoX4'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_yq2qi937ls0f3eDSi3CPUIqy', 'function': {'arguments': '{"dt":"2025-03-27T16:00:00","duration":45}', 'name': 'check_conflicting_appointment'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 33, 'prompt_tokens': 907, 'total_tokens': 940, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_d28bcae782', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-1d1cfce2-6a37-42f3-ab56-9bfc86ac8759-0', tool_calls=[{'name': 'check_conflicting_appointment', 'args': {'dt': '2025-03-27T16:00:00', 'duration': 45}, 'id': 'call_yq2qi937ls0f3eDSi3CPUIqy', 'type': 'tool_call'}], usage_metadata={'input_tokens': 907, 'output_tokens': 33, 'total_tokens': 940, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='Sorry, there is a conflict of appointment at 2025-03-27T16:00:00. However we suggest you to order at 2025-03-27T16:45:00.', name='check_conflicting_appointment', id='2687167f-5d7f-4457-96e3-c0e35f2efb6e', tool_call_id='call_yq2qi937ls0f3eDSi3CPUIqy'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_RBKDNjlBqLK6S4PCVhMJOfBO', 'function': {'arguments': '{"user_prompt":"Уучлаарай, 2025 оны 3 сарын 27-ны өдрийн 16:00 цагт бас боломжгүй байна. Та 16:45 цагт захиалга хийхийг зөвшөөрч байна уу?"}', 'name': 'ask_user_for_input'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 65, 'prompt_tokens': 994, 'total_tokens': 1059, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_d28bcae782', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-bc6c4bcc-1626-4fba-8cf6-a3824bf7cce0-0', tool_calls=[{'name': 'ask_user_for_input', 'args': {'user_prompt': 'Уучлаарай, 2025 оны 3 сарын 27-ны өдрийн 16:00 цагт бас боломжгүй байна. Та 16:45 цагт захиалга хийхийг зөвшөөрч байна уу?'}, 'id': 'call_RBKDNjlBqLK6S4PCVhMJOfBO', 'type': 'tool_call'}], usage_metadata={'input_tokens': 994, 'output_tokens': 65, 'total_tokens': 1059, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='За за тэгье даа, намайг бүртгэ.', name='ask_user_for_input', id='212da8f5-97d4-42b6-9f0f-f8cc67ee796f', tool_call_id='call_RBKDNjlBqLK6S4PCVhMJOfBO'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_jOnOn8AqUzmleokPuYjbSXCN', 'function': {'arguments': '{"appointment_time":"2025-03-27T16:45:00","branch":1,"name":"Эрдэнэбилэг","expected_duration":45}', 'name': 'set_appointment'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 46, 'prompt_tokens': 1082, 'total_tokens': 1128, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_d28bcae782', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-360aa880-d79a-41af-93d2-c9dbcd8fd0ca-0', tool_calls=[{'name': 'set_appointment', 'args': {'appointment_time': '2025-03-27T16:45:00', 'branch': 1, 'name': 'Эрдэнэбилэг', 'expected_duration': 45}, 'id': 'call_jOnOn8AqUzmleokPuYjbSXCN', 'type': 'tool_call'}], usage_metadata={'input_tokens': 1082, 'output_tokens': 46, 'total_tokens': 1128, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='{"created_date": "07/01/2025, 17:19:06", "expected_duration": 45, "branch": 1, "operation": "Trimming hair length shorter", "id": 10, "name": "Эрдэнэбилэг", "appointment_datetime": "2025-03-27T16:45:00"}', name='set_appointment', id='9c157527-ab92-41bb-871e-1ce3c79e99b4', tool_call_id='call_jOnOn8AqUzmleokPuYjbSXCN'), AIMessage(content='Таны захиалга амжилттай бүртгэгдсэн. Эрдэнэбилэг таны үс засалтын захиалга 2025 оны 3 сарын 27-ны өдрийн 16:45 цагт хийгдэх болно. Баярлалаа!', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 62, 'prompt_tokens': 1213, 'total_tokens': 1275, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_d28bcae782', 'finish_reason': 'stop', 'logprobs': None}, id='run-0027e693-9a9e-4081-9e62-7913f623b176-0', usage_metadata={'input_tokens': 1213, 'output_tokens': 62, 'total_tokens': 1275, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:__main__:{'messages': [SystemMessage(content='\n    You are a barbershop AI agent that makes haircut appointments for users. And you must communicate in\n    Mongolian language. You MUST use the following tools to assist users:\n    - ask_user_for_input: Use this to get necessary information from the user (you must let the user confirm the suggested time and ask again)\n    - check_conflicting_appointment: Use this to verify if the requested time slot is available\n    - set_appointment: Use this to create the final appointment\n\n    For each appointment, you need to:\n    1. Gather necessary information using ask_user_for_input (name, preferred date and time)\n    2. Check if the time slot is available using check_conflicting_appointment (duration is 45 minutes)\n    3. Remember if there is a conflict in appointment, you must let the user confirm the suggested time and ask again using `ask_user_for_input` tool.\n    4. Create the appointment using set_appointment\n\n    Always use these tools to complete the task. Do not provide fictional responses.\n    \n    Now begin! Start interacting with the user!\n', additional_kwargs={}, response_metadata={}, id='8c02162a-48f5-48e2-810a-96d2f4ba3901'), AIMessage(content='Сайн байна уу! Та үс засуулах цаг товлохыг хүсэж байна уу? Хэрэв тийм бол таны нэр, хүссэн өдөр, цагийг мэдэх хэрэгтэй байна. Эдгээр мэдээллийг оруулаарай.', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 52, 'prompt_tokens': 572, 'total_tokens': 624, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_d28bcae782', 'finish_reason': 'stop', 'logprobs': None}, id='run-e4d13c6e-d1d8-46c6-8d02-94e948ad8841-0', usage_metadata={'input_tokens': 572, 'output_tokens': 52, 'total_tokens': 624, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:__main__:{'messages': [SystemMessage(content='\n    You are a barbershop AI agent that makes haircut appointments for users. And you must communicate in\n    Mongolian language. You MUST use the following tools to assist users:\n    - ask_user_for_input: Use this to get necessary information from the user (you must let the user confirm the suggested time and ask again)\n    - check_conflicting_appointment: Use this to verify if the requested time slot is available\n    - set_appointment: Use this to create the final appointment\n\n    For each appointment, you need to:\n    1. Gather necessary information using ask_user_for_input (name, preferred date and time)\n    2. Check if the time slot is available using check_conflicting_appointment (duration is 45 minutes)\n    3. Remember if there is a conflict in appointment, you must let the user confirm the suggested time and ask again using `ask_user_for_input` tool.\n    4. Create the appointment using set_appointment\n\n    Always use these tools to complete the task. Do not provide fictional responses.\n', additional_kwargs={}, response_metadata={}, id='b77b8448-3a95-4ed4-8e04-d04d188c9daf'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_psueNX2tdSrKtx7AWf1Mm6sY', 'function': {'arguments': '{"user_prompt":"Таны нэрийг хэлнэ үү?"}', 'name': 'ask_user_for_input'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 26, 'prompt_tokens': 561, 'total_tokens': 587, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_d28bcae782', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-38d8c5e9-8816-43b7-8882-33e7c0df60e2-0', tool_calls=[{'name': 'ask_user_for_input', 'args': {'user_prompt': 'Таны нэрийг хэлнэ үү?'}, 'id': 'call_psueNX2tdSrKtx7AWf1Mm6sY', 'type': 'tool_call'}], usage_metadata={'input_tokens': 561, 'output_tokens': 26, 'total_tokens': 587, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='Эрдэнээ', name='ask_user_for_input', id='fd6f0299-2289-48d1-8f36-8f519eacecac', tool_call_id='call_psueNX2tdSrKtx7AWf1Mm6sY'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_M6lhRqUqQDFGBPfJahE7fFZq', 'function': {'arguments': '{"user_prompt":"Таны хүсэж буй үс засалтын өдөр, цагийг оруулна уу? (ISO форматаар бичнэ үү, жишээ нь: 2023-11-10T14:00:00)"}', 'name': 'ask_user_for_input'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 64, 'prompt_tokens': 600, 'total_tokens': 664, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_d28bcae782', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-f2bac80c-bd95-4a6f-8ff0-86ea46049956-0', tool_calls=[{'name': 'ask_user_for_input', 'args': {'user_prompt': 'Таны хүсэж буй үс засалтын өдөр, цагийг оруулна уу? (ISO форматаар бичнэ үү, жишээ нь: 2023-11-10T14:00:00)'}, 'id': 'call_M6lhRqUqQDFGBPfJahE7fFZq', 'type': 'tool_call'}], usage_metadata={'input_tokens': 600, 'output_tokens': 64, 'total_tokens': 664, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='энэ жилийн 3 сарын 27ны өдөр өглөө байхад болно', name='ask_user_for_input', id='c0f10802-eb77-4f16-8681-2b035c7d0bf7', tool_call_id='call_M6lhRqUqQDFGBPfJahE7fFZq'), AIMessage(content='Өдрийг тодорхой ISO форматаар оруулна уу? Жишээ нь: 2023-03-27T09:00:00.', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 36, 'prompt_tokens': 688, 'total_tokens': 724, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_d28bcae782', 'finish_reason': 'stop', 'logprobs': None}, id='run-74bb934f-aff1-4ab7-8955-5a58ae14a258-0', usage_metadata={'input_tokens': 688, 'output_tokens': 36, 'total_tokens': 724, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}
